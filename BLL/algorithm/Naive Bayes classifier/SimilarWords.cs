using DAL;
using EntityFrameWork;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Text;
using System.Threading.Tasks;

using System.Diagnostics;
using System.Security.Cryptography;

namespace BLL.algorithm.Naive_Bayes_classifier
{
    public class SimilarWords
    {
        private dynamic getMostSimilarWords;
        private ProcessStartInfo start;

        public SimilarWords() 
        {
        }
        public Dictionary<string,Dictionary<string,double>> getAllSimilarWords(List<wordInArticale> artWords,BuildProbilityMatrix data)
        {
            //יצירת מילון עם מפתח: מילה, ערך: מילון עם מפתח: מילה דומה, ערך: אחוז דמיון
            Dictionary<string, Dictionary<string, double>> allSimilarWords = new Dictionary<string, Dictionary<string, double>>();
            //Tasks יצירת רשימה לאחסון ה 
            List<Task<(string, Dictionary<string, double>)>> tasks = new List<Task<(string, Dictionary<string, double>)>>();
            foreach (var item in artWords)
            {
                //התחל משימה חדשה עבור כל מילה כדי לקבל את המילים הדומות לה
                Task<(string, Dictionary<string, double>)> task = Task.Run(() =>
                {
                    //שליחה לפונקציה המטפלת בהרצת סקריפט בפייתן כדי לקבל מילים דומות עבור המילה הנוכחית
                    return (item.Word, getSimilarWordsPython(item.Word));
                });
                //הוספת המשימה לרשימת המשימות
                tasks.Add(task);
            }
            foreach (var task in tasks)
            {
                //Tasks המתנה עד להשלמת כל ה    
                task.Wait();
                //החזרת המילה ואת המילים הדומות לה מהמשימה שהושלמה
                (string word, Dictionary<string, double> sw)= task.Result;
                //הוספה למילון את המילה והמילים הדומות לה
                if (!allSimilarWords.ContainsKey(word))
                    allSimilarWords.Add(word, sw);
            }
            //החזר את המילון המכיל את כל המילים הדומות
            return allSimilarWords;
        }
        
        public Dictionary<string, float> getSimilarWords(string word)
        {
            string htmlCode;
            int startP, endP, wordStart, wordWnd;
            string[] word1;
            float frequency;
            Dictionary<String, float> similarWords = new Dictionary<string, float>();
            using (WebClient client = new WebClient())
            {
                var htmldata = client.DownloadData("http://vectors.nlpl.eu/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/" + word + "/");
                //var htmldata = client.DownloadData("https://u.cs.biu.ac.il/~yogo/tw2v/similar/"+word);
                htmlCode = Encoding.UTF8.GetString(htmldata);
            }
            //htmlCode = "<!-- Look associates.html for more detailed comments -->\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head><title>Semantically related words for \"computer_NOUN\"</title>\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n  <meta charset=\"utf-8\">\r\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\r\n  <meta name=\"description\" content=\"WebVectors: word embeddings, web interface and models to download\">\r\n<meta name=\"robots\" content=\"noindex\">\r\n  <!-- Bootstrap -->\r\n  <link href=\"/explore/embeddings/data/css/bootstrap.min.css/\" rel=\"stylesheet\" media=\"screen\">\r\n  <link href=\"/explore/embeddings/data/css/typeahead.css/\" rel=\"stylesheet\">\r\n  <link href=\"/explore/embeddings/data/css/avatar.css/\" rel=\"stylesheet\" media=\"screen\">\r\n  <link href=\"/explore/embeddings/data/css/results.css/\" rel=\"stylesheet\" media=\"screen\">\r\n  <link href=\"/explore/embeddings/data/css/radio-and-checkbox.css/\" rel=\"stylesheet\" media=\"screen\">\r\n\r\n<meta name=\"NetsparkQuiltingResult\" total-length=\"44092\" removed=\"0\" rules-found=\"w5853,w3239,w10024,w6635,w6640,w3588,w3589,w2415,w2793,w2337,w6636,w5830,w5165,w7123,w3018,w5359,w3221,w8433,w8434,w5106,w5124,w5125,w5107,w7102,w4674,w4111,w4112,w4113,w3217,w7849,w20265,w34750\" />\r\n</head>\r\n<body>\r\n<nav class=\"navbar navbar-primary navbar-fixed-top\">\r\n  <div class=\"container\">\r\n    <div class=\"navbar-header\">\r\n      <button type=\"button\" class=\"navbar-toggle collapsed\" data-toggle=\"collapse\" data-target=\"#navbar\" aria-expanded=\"false\" aria-controls=\"navbar\">\r\n      <span class=\"sr-only\">Toggle Navigation</span>\r\n      <span class=\"icon-bar\"></span>\r\n      <span class=\"icon-bar\"></span>\r\n      <span class=\"icon-bar\"></span>\r\n      </button>\r\n      <a class=\"navbar-brand\" href=\"/explore/embeddings/en/\">WebVectors</a>\r\n    </div>\r\n    <div id=\"navbar\" class=\"collapse navbar-collapse\">\r\n      <ul class=\"nav navbar-nav\">\r\n        <li><a href=\"/explore/embeddings/en/associates/\">Similar words</a></li>\r\n        <li><a href=\"/explore/embeddings/en/visual/\">Visualizations</a></li>\r\n        <li><a href=\"/explore/embeddings/en/calculator/\">Calculator</a></li>\r\n        <li><a href=\"/explore/embeddings/en/contextual/\">2D text</a></li>\r\n        <li><a href=\"/explore/embeddings/en/misc/\">Miscellaneous</a></li>\r\n        <li><a href=\"/explore/embeddings/en/models/\">Models</a></li>\r\n        <li><a href=\"/explore/embeddings/en/about/\">About</a></li>\r\n      </ul>\r\n    </div>\r\n    <!--/.nav-collapse -->\r\n  </div>\r\n</nav>\r\n<div class=\"container\">\r\n  <div class=\"starter-template\">\r\n    <span><br><br><br></span>\r\n<!-- Featuring results --><script>\r\n  function ShowHide(divId)\r\n  {\r\n  if(document.getElementById(divId).style.display == 'none')\r\n  {\r\n  document.getElementById(divId).style.display='block';\r\n  }\r\n  else\r\n  {\r\n  document.getElementById(divId).style.display = 'none';\r\n  }\r\n  }\r\n</script>\r\n    <h2>What words are related&nbsp;to <span style = \"font-size:larger;\"><strong>\r\n      <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/computer_NOUN/\"\r\n      title=\" part of speech NOUN, corpus frequency 208695\"\r\n      class=\"frequency-high\">\r\n      &laquo;computer&raquo;</a></strong></span>\r\n      in&nbsp;model <a href=\"/explore/embeddings/en/models/#MOD_enwiki_upos_skipgram_300_2_2021\">&laquo;English Wikipedia&raquo;</a>?\r\n    </h2>\r\n<!-- Similar words list and graph -->\r\n<div class=\"row\" id=\"result\" data-query=\"computer_NOUN\" data-visible=\"10\" data-result ='{\"MOD_enwiki_upos_skipgram_300_2_2021\": {\"comput_NOUN\": [1640, \"mid\"], \"computer_NOUN\": [208695, \"high\"], \"computing_NOUN\": [2564, \"mid\"], \"electronics_NOUN\": [34117, \"high\"], \"hardware_NOUN\": [20511, \"mid\"], \"laptop_NOUN\": [8124, \"mid\"], \"macintosh_NOUN\": [2164, \"mid\"], \"mainframe_NOUN\": [2535, \"mid\"], \"mechatronics_NOUN\": [758, \"low\"], \"microcomputer_NOUN\": [1659, \"mid\"], \"microprocessor_NOUN\": [5137, \"mid\"], \"minicomputer_NOUN\": [1190, \"low\"], \"pc_NOUN\": [11322, \"mid\"], \"pdp-10_NOUN\": [284, \"low\"], \"peripheral_NOUN\": [2742, \"mid\"], \"robotics_NOUN\": [7382, \"mid\"], \"software_NOUN\": [82528, \"high\"], \"supercomputer_NOUN\": [3543, \"mid\"], \"workstation_NOUN\": [5346, \"mid\"]}}' data-graph='{\"MOD_enwiki_upos_skipgram_300_2_2021\": [{\"source\": \"computer_NOUN\", \"target\": \"computer_NOUN\", \"value\": 1}, {\"source\": \"computer_NOUN\", \"target\": \"microcomputer_NOUN\", \"value\": 0.6567606925964355}, {\"source\": \"computer_NOUN\", \"target\": \"laptop_NOUN\", \"value\": 0.6210439205169678}, {\"source\": \"computer_NOUN\", \"target\": \"mainframe_NOUN\", \"value\": 0.6069239377975464}, {\"source\": \"computer_NOUN\", \"target\": \"minicomputer_NOUN\", \"value\": 0.5942156314849854}, {\"source\": \"computer_NOUN\", \"target\": \"software_NOUN\", \"value\": 0.5874025225639343}, {\"source\": \"computer_NOUN\", \"target\": \"pc_NOUN\", \"value\": 0.5764753222465515}, {\"source\": \"computer_NOUN\", \"target\": \"comput_NOUN\", \"value\": 0.5699728727340698}, {\"source\": \"computer_NOUN\", \"target\": \"workstation_NOUN\", \"value\": 0.5616867542266846}, {\"source\": \"computer_NOUN\", \"target\": \"robotics_NOUN\", \"value\": 0.5491446852684021}, {\"source\": \"computer_NOUN\", \"target\": \"electronics_NOUN\", \"value\": 0.5473510026931763}, {\"source\": \"computer_NOUN\", \"target\": \"supercomputer_NOUN\", \"value\": 0.5461090803146362}, {\"source\": \"computer_NOUN\", \"target\": \"pdp-10_NOUN\", \"value\": 0.5450719594955444}, {\"source\": \"computer_NOUN\", \"target\": \"mechatronics_NOUN\", \"value\": 0.5355726480484009}, {\"source\": \"computer_NOUN\", \"target\": \"microprocessor_NOUN\", \"value\": 0.5333390831947327}, {\"source\": \"computer_NOUN\", \"target\": \"computing_NOUN\", \"value\": 0.5264768600463867}, {\"source\": \"computer_NOUN\", \"target\": \"macintosh_NOUN\", \"value\": 0.5197767019271851}, {\"source\": \"computer_NOUN\", \"target\": \"peripheral_NOUN\", \"value\": 0.5189247131347656}, {\"source\": \"computer_NOUN\", \"target\": \"hardware_NOUN\", \"value\": 0.5189175009727478}, {\"source\": \"microcomputer_NOUN\", \"target\": \"laptop_NOUN\", \"value\": 0.5507068634033203}, {\"source\": \"microcomputer_NOUN\", \"target\": \"mainframe_NOUN\", \"value\": 0.665434718132019}, {\"source\": \"microcomputer_NOUN\", \"target\": \"minicomputer_NOUN\", \"value\": 0.769759476184845}, {\"source\": \"microcomputer_NOUN\", \"target\": \"software_NOUN\", \"value\": 0.5454128384590149}, {\"source\": \"microcomputer_NOUN\", \"target\": \"pc_NOUN\", \"value\": 0.6321699619293213}, {\"source\": \"microcomputer_NOUN\", \"target\": \"comput_NOUN\", \"value\": 0.51502525806427}, {\"source\": \"microcomputer_NOUN\", \"target\": \"workstation_NOUN\", \"value\": 0.6030812859535217}, {\"source\": \"microcomputer_NOUN\", \"target\": \"robotics_NOUN\", \"value\": 0.4530620574951172}, {\"source\": \"microcomputer_NOUN\", \"target\": \"electronics_NOUN\", \"value\": 0.44278568029403687}, {\"source\": \"microcomputer_NOUN\", \"target\": \"supercomputer_NOUN\", \"value\": 0.5315368175506592}, {\"source\": \"microcomputer_NOUN\", \"target\": \"pdp-10_NOUN\", \"value\": 0.6299425363540649}, {\"source\": \"microcomputer_NOUN\", \"target\": \"mechatronics_NOUN\", \"value\": 0.34975236654281616}, {\"source\": \"microcomputer_NOUN\", \"target\": \"microprocessor_NOUN\", \"value\": 0.6956723928451538}, {\"source\": \"microcomputer_NOUN\", \"target\": \"computing_NOUN\", \"value\": 0.4267829954624176}, {\"source\": \"microcomputer_NOUN\", \"target\": \"macintosh_NOUN\", \"value\": 0.6459767818450928}, {\"source\": \"microcomputer_NOUN\", \"target\": \"peripheral_NOUN\", \"value\": 0.5730345845222473}, {\"source\": \"microcomputer_NOUN\", \"target\": \"hardware_NOUN\", \"value\": 0.5531257390975952}, {\"source\": \"laptop_NOUN\", \"target\": \"mainframe_NOUN\", \"value\": 0.5437604188919067}, {\"source\": \"laptop_NOUN\", \"target\": \"minicomputer_NOUN\", \"value\": 0.4903506338596344}, {\"source\": \"laptop_NOUN\", \"target\": \"software_NOUN\", \"value\": 0.4065164029598236}, {\"source\": \"laptop_NOUN\", \"target\": \"pc_NOUN\", \"value\": 0.6146659255027771}, {\"source\": \"laptop_NOUN\", \"target\": \"comput_NOUN\", \"value\": 0.3978089690208435}, {\"source\": \"laptop_NOUN\", \"target\": \"workstation_NOUN\", \"value\": 0.5803139209747314}, {\"source\": \"laptop_NOUN\", \"target\": \"robotics_NOUN\", \"value\": 0.29415518045425415}, {\"source\": \"laptop_NOUN\", \"target\": \"electronics_NOUN\", \"value\": 0.45202985405921936}, {\"source\": \"laptop_NOUN\", \"target\": \"supercomputer_NOUN\", \"value\": 0.4104023277759552}, {\"source\": \"laptop_NOUN\", \"target\": \"pdp-10_NOUN\", \"value\": 0.44516029953956604}, {\"source\": \"laptop_NOUN\", \"target\": \"mechatronics_NOUN\", \"value\": 0.2940358519554138}, {\"source\": \"laptop_NOUN\", \"target\": \"microprocessor_NOUN\", \"value\": 0.5028536915779114}, {\"source\": \"laptop_NOUN\", \"target\": \"computing_NOUN\", \"value\": 0.28902798891067505}, {\"source\": \"laptop_NOUN\", \"target\": \"macintosh_NOUN\", \"value\": 0.5358124375343323}, {\"source\": \"laptop_NOUN\", \"target\": \"peripheral_NOUN\", \"value\": 0.534077525138855}, {\"source\": \"laptop_NOUN\", \"target\": \"hardware_NOUN\", \"value\": 0.47294557094573975}, {\"source\": \"mainframe_NOUN\", \"target\": \"minicomputer_NOUN\", \"value\": 0.7261276841163635}, {\"source\": \"mainframe_NOUN\", \"target\": \"software_NOUN\", \"value\": 0.5575554370880127}, {\"source\": \"mainframe_NOUN\", \"target\": \"pc_NOUN\", \"value\": 0.6195338368415833}, {\"source\": \"mainframe_NOUN\", \"target\": \"comput_NOUN\", \"value\": 0.5229950547218323}, {\"source\": \"mainframe_NOUN\", \"target\": \"workstation_NOUN\", \"value\": 0.6415355205535889}, {\"source\": \"mainframe_NOUN\", \"target\": \"robotics_NOUN\", \"value\": 0.37747862935066223}, {\"source\": \"mainframe_NOUN\", \"target\": \"electronics_NOUN\", \"value\": 0.32132023572921753}, {\"source\": \"mainframe_NOUN\", \"target\": \"supercomputer_NOUN\", \"value\": 0.6026933789253235}, {\"source\": \"mainframe_NOUN\", \"target\": \"pdp-10_NOUN\", \"value\": 0.6529344320297241}, {\"source\": \"mainframe_NOUN\", \"target\": \"mechatronics_NOUN\", \"value\": 0.34151166677474976}, {\"source\": \"mainframe_NOUN\", \"target\": \"microprocessor_NOUN\", \"value\": 0.6162813305854797}, {\"source\": \"mainframe_NOUN\", \"target\": \"computing_NOUN\", \"value\": 0.3834335505962372}, {\"source\": \"mainframe_NOUN\", \"target\": \"macintosh_NOUN\", \"value\": 0.6249306201934814}, {\"source\": \"mainframe_NOUN\", \"target\": \"peripheral_NOUN\", \"value\": 0.5387620329856873}, {\"source\": \"mainframe_NOUN\", \"target\": \"hardware_NOUN\", \"value\": 0.5464670062065125}, {\"source\": \"minicomputer_NOUN\", \"target\": \"software_NOUN\", \"value\": 0.5155006647109985}, {\"source\": \"minicomputer_NOUN\", \"target\": \"pc_NOUN\", \"value\": 0.5802978277206421}, {\"source\": \"minicomputer_NOUN\", \"target\": \"comput_NOUN\", \"value\": 0.5038776993751526}, {\"source\": \"minicomputer_NOUN\", \"target\": \"workstation_NOUN\", \"value\": 0.6502577662467957}, {\"source\": \"minicomputer_NOUN\", \"target\": \"robotics_NOUN\", \"value\": 0.3573894202709198}, {\"source\": \"minicomputer_NOUN\", \"target\": \"electronics_NOUN\", \"value\": 0.38357678055763245}, {\"source\": \"minicomputer_NOUN\", \"target\": \"supercomputer_NOUN\", \"value\": 0.5922670364379883}, {\"source\": \"minicomputer_NOUN\", \"target\": \"pdp-10_NOUN\", \"value\": 0.6792899966239929}, {\"source\": \"minicomputer_NOUN\", \"target\": \"mechatronics_NOUN\", \"value\": 0.33922088146209717}, {\"source\": \"minicomputer_NOUN\", \"target\": \"microprocessor_NOUN\", \"value\": 0.7122498750686646}, {\"source\": \"minicomputer_NOUN\", \"target\": \"computing_NOUN\", \"value\": 0.3968566060066223}, {\"source\": \"minicomputer_NOUN\", \"target\": \"macintosh_NOUN\", \"value\": 0.5965848565101624}, {\"source\": \"minicomputer_NOUN\", \"target\": \"peripheral_NOUN\", \"value\": 0.5592958927154541}, {\"source\": \"minicomputer_NOUN\", \"target\": \"hardware_NOUN\", \"value\": 0.5761559009552002}, {\"source\": \"software_NOUN\", \"target\": \"pc_NOUN\", \"value\": 0.5574736595153809}, {\"source\": \"software_NOUN\", \"target\": \"comput_NOUN\", \"value\": 0.5008111000061035}, {\"source\": \"software_NOUN\", \"target\": \"workstation_NOUN\", \"value\": 0.6035639643669128}, {\"source\": \"software_NOUN\", \"target\": \"robotics_NOUN\", \"value\": 0.4783872663974762}, {\"source\": \"software_NOUN\", \"target\": \"electronics_NOUN\", \"value\": 0.40429234504699707}, {\"source\": \"software_NOUN\", \"target\": \"supercomputer_NOUN\", \"value\": 0.4686742126941681}, {\"source\": \"software_NOUN\", \"target\": \"pdp-10_NOUN\", \"value\": 0.5594964623451233}, {\"source\": \"software_NOUN\", \"target\": \"mechatronics_NOUN\", \"value\": 0.3883151412010193}, {\"source\": \"software_NOUN\", \"target\": \"microprocessor_NOUN\", \"value\": 0.4919193983078003}, {\"source\": \"software_NOUN\", \"target\": \"computing_NOUN\", \"value\": 0.48494401574134827}, {\"source\": \"software_NOUN\", \"target\": \"macintosh_NOUN\", \"value\": 0.5470878481864929}, {\"source\": \"software_NOUN\", \"target\": \"peripheral_NOUN\", \"value\": 0.5517279505729675}, {\"source\": \"software_NOUN\", \"target\": \"hardware_NOUN\", \"value\": 0.639398992061615}, {\"source\": \"pc_NOUN\", \"target\": \"comput_NOUN\", \"value\": 0.4556090235710144}, {\"source\": \"pc_NOUN\", \"target\": \"workstation_NOUN\", \"value\": 0.6041381359100342}, {\"source\": \"pc_NOUN\", \"target\": \"robotics_NOUN\", \"value\": 0.2538256347179413}, {\"source\": \"pc_NOUN\", \"target\": \"electronics_NOUN\", \"value\": 0.30452197790145874}, {\"source\": \"pc_NOUN\", \"target\": \"supercomputer_NOUN\", \"value\": 0.448701411485672}, {\"source\": \"pc_NOUN\", \"target\": \"pdp-10_NOUN\", \"value\": 0.5707203149795532}, {\"source\": \"pc_NOUN\", \"target\": \"mechatronics_NOUN\", \"value\": 0.22876214981079102}, {\"source\": \"pc_NOUN\", \"target\": \"microprocessor_NOUN\", \"value\": 0.5492961406707764}, {\"source\": \"pc_NOUN\", \"target\": \"computing_NOUN\", \"value\": 0.33448609709739685}, {\"source\": \"pc_NOUN\", \"target\": \"macintosh_NOUN\", \"value\": 0.6492775082588196}, {\"source\": \"pc_NOUN\", \"target\": \"peripheral_NOUN\", \"value\": 0.6269413828849792}, {\"source\": \"pc_NOUN\", \"target\": \"hardware_NOUN\", \"value\": 0.5582870841026306}, {\"source\": \"comput_NOUN\", \"target\": \"workstation_NOUN\", \"value\": 0.5086848139762878}, {\"source\": \"comput_NOUN\", \"target\": \"robotics_NOUN\", \"value\": 0.5176311135292053}, {\"source\": \"comput_NOUN\", \"target\": \"electronics_NOUN\", \"value\": 0.35427573323249817}, {\"source\": \"comput_NOUN\", \"target\": \"supercomputer_NOUN\", \"value\": 0.5445268154144287}, {\"source\": \"comput_NOUN\", \"target\": \"pdp-10_NOUN\", \"value\": 0.4751725494861603}, {\"source\": \"comput_NOUN\", \"target\": \"mechatronics_NOUN\", \"value\": 0.41445890069007874}, {\"source\": \"comput_NOUN\", \"target\": \"microprocessor_NOUN\", \"value\": 0.49713271856307983}, {\"source\": \"comput_NOUN\", \"target\": \"computing_NOUN\", \"value\": 0.6389786601066589}, {\"source\": \"comput_NOUN\", \"target\": \"macintosh_NOUN\", \"value\": 0.4519366919994354}, {\"source\": \"comput_NOUN\", \"target\": \"peripheral_NOUN\", \"value\": 0.42556676268577576}, {\"source\": \"comput_NOUN\", \"target\": \"hardware_NOUN\", \"value\": 0.499524861574173}, {\"source\": \"workstation_NOUN\", \"target\": \"robotics_NOUN\", \"value\": 0.4035857617855072}, {\"source\": \"workstation_NOUN\", \"target\": \"electronics_NOUN\", \"value\": 0.36563748121261597}, {\"source\": \"workstation_NOUN\", \"target\": \"supercomputer_NOUN\", \"value\": 0.5602982044219971}, {\"source\": \"workstation_NOUN\", \"target\": \"pdp-10_NOUN\", \"value\": 0.5799649953842163}, {\"source\": \"workstation_NOUN\", \"target\": \"mechatronics_NOUN\", \"value\": 0.35243940353393555}, {\"source\": \"workstation_NOUN\", \"target\": \"microprocessor_NOUN\", \"value\": 0.6500665545463562}, {\"source\": \"workstation_NOUN\", \"target\": \"computing_NOUN\", \"value\": 0.4405485987663269}, {\"source\": \"workstation_NOUN\", \"target\": \"macintosh_NOUN\", \"value\": 0.5699049234390259}, {\"source\": \"workstation_NOUN\", \"target\": \"peripheral_NOUN\", \"value\": 0.5849106907844543}, {\"source\": \"workstation_NOUN\", \"target\": \"hardware_NOUN\", \"value\": 0.5791956782341003}, {\"source\": \"robotics_NOUN\", \"target\": \"electronics_NOUN\", \"value\": 0.4819057583808899}, {\"source\": \"robotics_NOUN\", \"target\": \"supercomputer_NOUN\", \"value\": 0.41578954458236694}, {\"source\": \"robotics_NOUN\", \"target\": \"pdp-10_NOUN\", \"value\": 0.37369677424430847}, {\"source\": \"robotics_NOUN\", \"target\": \"mechatronics_NOUN\", \"value\": 0.6291549205780029}, {\"source\": \"robotics_NOUN\", \"target\": \"microprocessor_NOUN\", \"value\": 0.36203083395957947}, {\"source\": \"robotics_NOUN\", \"target\": \"computing_NOUN\", \"value\": 0.5280710458755493}, {\"source\": \"robotics_NOUN\", \"target\": \"macintosh_NOUN\", \"value\": 0.2580728530883789}, {\"source\": \"robotics_NOUN\", \"target\": \"peripheral_NOUN\", \"value\": 0.3130858540534973}, {\"source\": \"robotics_NOUN\", \"target\": \"hardware_NOUN\", \"value\": 0.3840061128139496}, {\"source\": \"electronics_NOUN\", \"target\": \"supercomputer_NOUN\", \"value\": 0.31429919600486755}, {\"source\": \"electronics_NOUN\", \"target\": \"pdp-10_NOUN\", \"value\": 0.30564597249031067}, {\"source\": \"electronics_NOUN\", \"target\": \"mechatronics_NOUN\", \"value\": 0.5984172821044922}, {\"source\": \"electronics_NOUN\", \"target\": \"microprocessor_NOUN\", \"value\": 0.4196518659591675}, {\"source\": \"electronics_NOUN\", \"target\": \"computing_NOUN\", \"value\": 0.40592435002326965}, {\"source\": \"electronics_NOUN\", \"target\": \"macintosh_NOUN\", \"value\": 0.2854274809360504}, {\"source\": \"electronics_NOUN\", \"target\": \"peripheral_NOUN\", \"value\": 0.422550231218338}, {\"source\": \"electronics_NOUN\", \"target\": \"hardware_NOUN\", \"value\": 0.49182242155075073}, {\"source\": \"supercomputer_NOUN\", \"target\": \"pdp-10_NOUN\", \"value\": 0.570543110370636}, {\"source\": \"supercomputer_NOUN\", \"target\": \"mechatronics_NOUN\", \"value\": 0.3243439197540283}, {\"source\": \"supercomputer_NOUN\", \"target\": \"microprocessor_NOUN\", \"value\": 0.5795512199401855}, {\"source\": \"supercomputer_NOUN\", \"target\": \"computing_NOUN\", \"value\": 0.45203617215156555}, {\"source\": \"supercomputer_NOUN\", \"target\": \"macintosh_NOUN\", \"value\": 0.4572577178478241}, {\"source\": \"supercomputer_NOUN\", \"target\": \"peripheral_NOUN\", \"value\": 0.35650834441185}, {\"source\": \"supercomputer_NOUN\", \"target\": \"hardware_NOUN\", \"value\": 0.43315181136131287}, {\"source\": \"pdp-10_NOUN\", \"target\": \"mechatronics_NOUN\", \"value\": 0.30890414118766785}, {\"source\": \"pdp-10_NOUN\", \"target\": \"microprocessor_NOUN\", \"value\": 0.6101931929588318}, {\"source\": \"pdp-10_NOUN\", \"target\": \"computing_NOUN\", \"value\": 0.39456668496131897}, {\"source\": \"pdp-10_NOUN\", \"target\": \"macintosh_NOUN\", \"value\": 0.6153570413589478}, {\"source\": \"pdp-10_NOUN\", \"target\": \"peripheral_NOUN\", \"value\": 0.5045727491378784}, {\"source\": \"pdp-10_NOUN\", \"target\": \"hardware_NOUN\", \"value\": 0.4967358708381653}, {\"source\": \"mechatronics_NOUN\", \"target\": \"microprocessor_NOUN\", \"value\": 0.3164414167404175}, {\"source\": \"mechatronics_NOUN\", \"target\": \"computing_NOUN\", \"value\": 0.5689451098442078}, {\"source\": \"mechatronics_NOUN\", \"target\": \"macintosh_NOUN\", \"value\": 0.21345393359661102}, {\"source\": \"mechatronics_NOUN\", \"target\": \"peripheral_NOUN\", \"value\": 0.3121386468410492}, {\"source\": \"mechatronics_NOUN\", \"target\": \"hardware_NOUN\", \"value\": 0.37690141797065735}, {\"source\": \"microprocessor_NOUN\", \"target\": \"computing_NOUN\", \"value\": 0.40321770310401917}, {\"source\": \"microprocessor_NOUN\", \"target\": \"macintosh_NOUN\", \"value\": 0.5812466144561768}, {\"source\": \"microprocessor_NOUN\", \"target\": \"peripheral_NOUN\", \"value\": 0.6294658184051514}, {\"source\": \"microprocessor_NOUN\", \"target\": \"hardware_NOUN\", \"value\": 0.6049357056617737}, {\"source\": \"computing_NOUN\", \"target\": \"macintosh_NOUN\", \"value\": 0.3489142954349518}, {\"source\": \"computing_NOUN\", \"target\": \"peripheral_NOUN\", \"value\": 0.31816309690475464}, {\"source\": \"computing_NOUN\", \"target\": \"hardware_NOUN\", \"value\": 0.38743606209754944}, {\"source\": \"macintosh_NOUN\", \"target\": \"peripheral_NOUN\", \"value\": 0.5493605732917786}, {\"source\": \"macintosh_NOUN\", \"target\": \"hardware_NOUN\", \"value\": 0.5432555079460144}, {\"source\": \"peripheral_NOUN\", \"target\": \"hardware_NOUN\", \"value\": 0.6449991464614868}]}'>\r\n  <!-- Header: \"What words are related to [word] in model [model]?\"\" -->\r\n  <div class=\"col-md-6\">\r\n    <!-- Checkbox for frequency selection -->\r\n    <div class=\"checkbox\" id=\"frequencyCheck\">\r\n      <p><em>Word frequency</em></p>\r\n      <label class=\"frequency-high\" title=\"Very frequent words: corpus ratio higher than 0.00001\">\r\n      <input id=\"high\" type=\"checkbox\" checked>High</label>\r\n      <label class=\"frequency-mid\" title=\"Mid-frequent words: corpus ratio from 0.0000005 to 0.00001\">\r\n      <input id=\"mid\" type=\"checkbox\" checked>Medium</label>\r\n      <label class=\"frequency-low\" title=\"Rare words: corpus ratio less than 0.0000005\">\r\n      <input id=\"low\" type=\"checkbox\">Low</label>\r\n    </div>\r\n    <!-- If the word is not present in the model but its embedding is inferred from its characters -->\r\n    <div id=\"list\">\r\n      <ol id=\"MOD_enwiki_upos_skipgram_300_2_2021\" style=\"max-width:300px;\">\r\n        <li class=\"frequency-item-mid\" data-word=\"microcomputer_NOUN\">\r\n        <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/microcomputer_NOUN/\"\r\n        title=\" part of speech NOUN, corpus frequency 1659\"\r\n        class=\"frequency-mid\">\r\n        \r\n        microcomputer\r\n        <sub style=\"font-size:50%;\">NOUN</sub>\r\n        \r\n        \r\n        </a>\r\n        0.6568 \r\n        <div class=\"avataricon\">\r\n          <a href=\"https://en.wikipedia.org/wiki/microcomputer\" target=\"_blank\">\r\n          <img src = \"https://en.wikipedia.org/wiki/Special:FilePath/Commodore-64-Computer.jpg?width=300\" alt = \"Microcomputer in&nbsp;Wikipedia\"\r\n            title = \"Microcomputer in&nbsp;Wikipedia\" width=\"30\">\r\n          </a>\r\n        </div>\r\n        </li>\r\n        <li class=\"frequency-item-mid\" data-word=\"laptop_NOUN\">\r\n        <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/laptop_NOUN/\"\r\n        title=\" part of speech NOUN, corpus frequency 8124\"\r\n        class=\"frequency-mid\">\r\n        \r\n        laptop\r\n        <sub style=\"font-size:50%;\">NOUN</sub>\r\n        \r\n        \r\n        </a>\r\n        0.6210 \r\n        <div class=\"avataricon\">\r\n          <a href=\"https://en.wikipedia.org/wiki/laptop\" target=\"_blank\">\r\n          <img src = \"https://commons.wikimedia.org/wiki/Special:FilePath/MacBook_Pro_Retina_3.jpg?width=300\" alt = \"Laptop in&nbsp;Wikipedia\"\r\n            title = \"Laptop in&nbsp;Wikipedia\" width=\"30\">\r\n          </a>\r\n        </div>\r\n        </li>\r\n        <li class=\"frequency-item-mid\" data-word=\"mainframe_NOUN\">\r\n        <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/mainframe_NOUN/\"\r\n        title=\" part of speech NOUN, corpus frequency 2535\"\r\n        class=\"frequency-mid\">\r\n        \r\n        mainframe\r\n        <sub style=\"font-size:50%;\">NOUN</sub>\r\n        \r\n        \r\n        </a>\r\n        0.6069 \r\n        </li>\r\n        <li class=\"frequency-item-low\" data-word=\"minicomputer_NOUN\">\r\n        <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/minicomputer_NOUN/\"\r\n        title=\" part of speech NOUN, corpus frequency 1190\"\r\n        class=\"frequency-low\">\r\n        \r\n        minicomputer\r\n        <sub style=\"font-size:50%;\">NOUN</sub>\r\n        \r\n        \r\n        </a>\r\n        0.5942 \r\n        <div class=\"avataricon\">\r\n          <a href=\"https://en.wikipedia.org/wiki/minicomputer\" target=\"_blank\">\r\n          <img src = \"https://commons.wikimedia.org/wiki/Special:FilePath/PDP-8.jpg?width=300\" alt = \"Minicomputer in&nbsp;Wikipedia\"\r\n            title = \"Minicomputer in&nbsp;Wikipedia\" width=\"30\">\r\n          </a>\r\n        </div>\r\n        </li>\r\n        <li class=\"frequency-item-high\" data-word=\"software_NOUN\">\r\n        <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/software_NOUN/\"\r\n        title=\" part of speech NOUN, corpus frequency 82528\"\r\n        class=\"frequency-high\">\r\n        \r\n        software\r\n        <sub style=\"font-size:50%;\">NOUN</sub>\r\n        \r\n        \r\n        </a>\r\n        0.5874 \r\n        <div class=\"avataricon\">\r\n          <a href=\"https://en.wikipedia.org/wiki/software\" target=\"_blank\">\r\n          <img src = \"https://commons.wikimedia.org/wiki/Special:FilePath/Operating_system_placement_(software).svg?width=300\" alt = \"Software in&nbsp;Wikipedia\"\r\n            title = \"Software in&nbsp;Wikipedia\" width=\"30\">\r\n          </a>\r\n        </div>\r\n        </li>\r\n        <li class=\"frequency-item-mid\" data-word=\"pc_NOUN\">\r\n        <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/pc_NOUN/\"\r\n        title=\" part of speech NOUN, corpus frequency 11322\"\r\n        class=\"frequency-mid\">\r\n        \r\n        pc\r\n        <sub style=\"font-size:50%;\">NOUN</sub>\r\n        \r\n        \r\n        </a>\r\n        0.5765 \r\n        </li>\r\n        <li class=\"frequency-item-mid\" data-word=\"comput_NOUN\">\r\n        <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/comput_NOUN/\"\r\n        title=\" part of speech NOUN, corpus frequency 1640\"\r\n        class=\"frequency-mid\">\r\n        \r\n        comput\r\n        <sub style=\"font-size:50%;\">NOUN</sub>\r\n        \r\n        \r\n        </a>\r\n        0.5700 \r\n        </li>\r\n        <li class=\"frequency-item-mid\" data-word=\"workstation_NOUN\">\r\n        <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/workstation_NOUN/\"\r\n        title=\" part of speech NOUN, corpus frequency 5346\"\r\n        class=\"frequency-mid\">\r\n        \r\n        workstation\r\n        <sub style=\"font-size:50%;\">NOUN</sub>\r\n        \r\n        \r\n        </a>\r\n        0.5617 \r\n        <div class=\"avataricon\">\r\n          <a href=\"https://en.wikipedia.org/wiki/workstation\" target=\"_blank\">\r\n          <img src = \"https://commons.wikimedia.org/wiki/Special:FilePath/Sun_SparcStation_10_with_CRT.jpg?width=300\" alt = \"Workstation in&nbsp;Wikipedia\"\r\n            title = \"Workstation in&nbsp;Wikipedia\" width=\"30\">\r\n          </a>\r\n        </div>\r\n        </li>\r\n        <li class=\"frequency-item-mid\" data-word=\"robotics_NOUN\">\r\n        <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/robotics_NOUN/\"\r\n        title=\" part of speech NOUN, corpus frequency 7382\"\r\n        class=\"frequency-mid\">\r\n        \r\n        robotics\r\n        <sub style=\"font-size:50%;\">NOUN</sub>\r\n        \r\n        \r\n        </a>\r\n        0.5491 \r\n        <div class=\"avataricon\">\r\n          <a href=\"https://en.wikipedia.org/wiki/robotics\" target=\"_blank\">\r\n          <img src = \"https://commons.wikimedia.org/wiki/Special:FilePath/Shadow_Hand_Bulb_large.jpg?width=300\" alt = \"Robotics in&nbsp;Wikipedia\"\r\n            title = \"Robotics in&nbsp;Wikipedia\" width=\"30\">\r\n          </a>\r\n        </div>\r\n        </li>\r\n        <li class=\"frequency-item-high\" data-word=\"electronics_NOUN\">\r\n        <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/electronics_NOUN/\"\r\n        title=\" part of speech NOUN, corpus frequency 34117\"\r\n        class=\"frequency-high\">\r\n        \r\n        electronics\r\n        <sub style=\"font-size:50%;\">NOUN</sub>\r\n        \r\n        \r\n        </a>\r\n        0.5474 \r\n        <div class=\"avataricon\">\r\n          <a href=\"https://en.wikipedia.org/wiki/electronics\" target=\"_blank\">\r\n          <img src = \"https://commons.wikimedia.org/wiki/Special:FilePath/Arduino_ftdi_chip-1.jpg?width=300\" alt = \"Electronics in&nbsp;Wikipedia\"\r\n            title = \"Electronics in&nbsp;Wikipedia\" width=\"30\">\r\n          </a>\r\n        </div>\r\n        </li>\r\n        <li class=\"frequency-item-mid\" data-word=\"supercomputer_NOUN\">\r\n        <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/supercomputer_NOUN/\"\r\n        title=\" part of speech NOUN, corpus frequency 3543\"\r\n        class=\"frequency-mid\">\r\n        \r\n        supercomputer\r\n        <sub style=\"font-size:50%;\">NOUN</sub>\r\n        \r\n        \r\n        </a>\r\n        0.5461 \r\n        <div class=\"avataricon\">\r\n          <a href=\"https://en.wikipedia.org/wiki/supercomputer\" target=\"_blank\">\r\n          <img src = \"https://commons.wikimedia.org/wiki/Special:FilePath/IBM_Blue_Gene_P_supercomputer.jpg?width=300\" alt = \"Supercomputer in&nbsp;Wikipedia\"\r\n            title = \"Supercomputer in&nbsp;Wikipedia\" width=\"30\">\r\n          </a>\r\n        </div>\r\n        </li>\r\n        <li class=\"frequency-item-low\" data-word=\"pdp-10_NOUN\">\r\n        <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/pdp-10_NOUN/\"\r\n        title=\" part of speech NOUN, corpus frequency 284\"\r\n        class=\"frequency-low\">\r\n        \r\n        pdp-10\r\n        <sub style=\"font-size:50%;\">NOUN</sub>\r\n        \r\n        \r\n        </a>\r\n        0.5451 \r\n        </li>\r\n        <li class=\"frequency-item-low\" data-word=\"mechatronics_NOUN\">\r\n        <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/mechatronics_NOUN/\"\r\n        title=\" part of speech NOUN, corpus frequency 758\"\r\n        class=\"frequency-low\">\r\n        \r\n        mechatronics\r\n        <sub style=\"font-size:50%;\">NOUN</sub>\r\n        \r\n        \r\n        </a>\r\n        0.5356 \r\n        <div class=\"avataricon\">\r\n          <a href=\"https://en.wikipedia.org/wiki/mechatronics\" target=\"_blank\">\r\n          <img src = \"https://commons.wikimedia.org/wiki/Special:FilePath/Mecha_workaround.svg?width=300\" alt = \"Mechatronics in&nbsp;Wikipedia\"\r\n            title = \"Mechatronics in&nbsp;Wikipedia\" width=\"30\">\r\n          </a>\r\n        </div>\r\n        </li>\r\n        <li class=\"frequency-item-mid\" data-word=\"microprocessor_NOUN\">\r\n        <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/microprocessor_NOUN/\"\r\n        title=\" part of speech NOUN, corpus frequency 5137\"\r\n        class=\"frequency-mid\">\r\n        \r\n        microprocessor\r\n        <sub style=\"font-size:50%;\">NOUN</sub>\r\n        \r\n        \r\n        </a>\r\n        0.5333 \r\n        <div class=\"avataricon\">\r\n          <a href=\"https://en.wikipedia.org/wiki/microprocessor\" target=\"_blank\">\r\n          <img src = \"https://commons.wikimedia.org/wiki/Special:FilePath/Z80_arch.svg?width=300\" alt = \"Microprocessor in&nbsp;Wikipedia\"\r\n            title = \"Microprocessor in&nbsp;Wikipedia\" width=\"30\">\r\n          </a>\r\n        </div>\r\n        </li>\r\n        <li class=\"frequency-item-mid\" data-word=\"computing_NOUN\">\r\n        <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/computing_NOUN/\"\r\n        title=\" part of speech NOUN, corpus frequency 2564\"\r\n        class=\"frequency-mid\">\r\n        \r\n        computing\r\n        <sub style=\"font-size:50%;\">NOUN</sub>\r\n        \r\n        \r\n        </a>\r\n        0.5265 \r\n        <div class=\"avataricon\">\r\n          <a href=\"https://en.wikipedia.org/wiki/computing\" target=\"_blank\">\r\n          <img src = \"https://commons.wikimedia.org/wiki/Special:FilePath/Babbage_Difference_Engine_(Being_utilised).jpg?width=300\" alt = \"Computing in&nbsp;Wikipedia\"\r\n            title = \"Computing in&nbsp;Wikipedia\" width=\"30\">\r\n          </a>\r\n        </div>\r\n        </li>\r\n        <li class=\"frequency-item-mid\" data-word=\"macintosh_NOUN\">\r\n        <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/macintosh_NOUN/\"\r\n        title=\" part of speech NOUN, corpus frequency 2164\"\r\n        class=\"frequency-mid\">\r\n        \r\n        macintosh\r\n        <sub style=\"font-size:50%;\">NOUN</sub>\r\n        \r\n        \r\n        </a>\r\n        0.5198 \r\n        <div class=\"avataricon\">\r\n          <a href=\"https://en.wikipedia.org/wiki/macintosh\" target=\"_blank\">\r\n          <img src = \"https://commons.wikimedia.org/wiki/Special:FilePath/Macintosh_128k_transparency.png?width=300\" alt = \"Macintosh in&nbsp;Wikipedia\"\r\n            title = \"Macintosh in&nbsp;Wikipedia\" width=\"30\">\r\n          </a>\r\n        </div>\r\n        </li>\r\n        <li class=\"frequency-item-mid\" data-word=\"peripheral_NOUN\">\r\n        <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/peripheral_NOUN/\"\r\n        title=\" part of speech NOUN, corpus frequency 2742\"\r\n        class=\"frequency-mid\">\r\n        \r\n        peripheral\r\n        <sub style=\"font-size:50%;\">NOUN</sub>\r\n        \r\n        \r\n        </a>\r\n        0.5189 \r\n        <div class=\"avataricon\">\r\n          <a href=\"https://en.wikipedia.org/wiki/peripheral\" target=\"_blank\">\r\n          <img src = \"https://commons.wikimedia.org/wiki/Special:FilePath/Linux_kernel_and_gaming_input-output_latency.svg?width=300\" alt = \"Peripheral in&nbsp;Wikipedia\"\r\n            title = \"Peripheral in&nbsp;Wikipedia\" width=\"30\">\r\n          </a>\r\n        </div>\r\n        </li>\r\n        <li class=\"frequency-item-mid\" data-word=\"hardware_NOUN\">\r\n        <a href=\"/explore/embeddings/en/MOD_enwiki_upos_skipgram_300_2_2021/hardware_NOUN/\"\r\n        title=\" part of speech NOUN, corpus frequency 20511\"\r\n        class=\"frequency-mid\">\r\n        \r\n        hardware\r\n        <sub style=\"font-size:50%;\">NOUN</sub>\r\n        \r\n        \r\n        </a>\r\n        0.5189 \r\n        </li></ol>\r\n    </div>\r\n    <ul>\r\n      <li>\r\n        <p><i>We show only the associates of the same part of speech as your query. All associates can be found at the <a href=\"http://vectors.nlpl.eu/explore/embeddings/en/associates/\">Similar Words</a> tab.</i></p>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n  <div class=\"col-md-6\" id=\"graph\">\r\n    <svg></svg>\r\n    <fieldset class=\"form-inline\" style=\"text-align: center;\">\r\n      <input class=\"form-control\" style=\"max-width:75px; display: inline-block;\" type=\"number\" id=\"threshold\" min=\"0\" max=\"1\" step=\"0.1\" value=\"0.6\">\r\n      <label for=\"threshold\" title=\"Edges between word pairs with lower cosine similarity will be hidden\">Similarity threshold</label>\r\n      <!-- number of neighbours\r\n      <input class=\"form-control\" style=\"max-width:75px;\" type=\"number\" id=\"topn\" min=\"0\" max=\"10\" step=\"1\" value=\"10\">\r\n      <label for=\"topn\" title=\"Maximum possible number. It can depend on words' frequency in result\">Number of neighbours</label>\r\n      -->\r\n      <label>\r\n        <input type=\"checkbox\" id=\"separator\"> Show tags\r\n      </label>\r\n    </fieldset>\r\n  </div>\r\n</div>\r\n  <hr>\r\n  <!-- About the word and vector components on the plot-->\r\n<div class=\"row\">\r\n  <div class=\"col-md-6\">\r\n    <!-- Links to the word in another models -->\r\n    <h2>This word in&nbsp;other models</h2>\r\n    <ul>\r\n      <li>\r\n        <a href=\"/explore/embeddings/en/MOD_bnc_upos_skipgram_300_10_2017/computer_NOUN/\">British National Corpus</a>\r\n      </li>\r\n      <li>\r\n        <a href=\"/explore/embeddings/en/MOD_googlenews_upos_skipgram_300_xxx_2013/computer_NOUN/\">Google News</a>\r\n      </li>\r\n      <li>\r\n        <a href=\"/explore/embeddings/en/MOD_gigaword_upos_skipgram_300_2_2018/computer_NOUN/\">English Gigaword</a>\r\n      </li>\r\n      <li>\r\n        <a href=\"/explore/embeddings/en/MOD_naknowac_upos_skipgram_300_5_2017/computer_NOUN/\">Norsk Aviskorpus</a>\r\n      </li>\r\n    </ul>\r\n    <!-- Show the word's raw vector in another models -->\r\n    <span style = \"font-size:larger;\">\r\n    <a onclick =\"javascript:ShowHide('HiddenDiv')\" href=\"javascript:;\" >Show the raw vector&nbsp;of &laquo;computer&raquo;\r\n    in&nbsp;model MOD_enwiki_upos_skipgram_300_2_2021:</a>\r\n    </span>\r\n    <div class=\"vector\" id=\"HiddenDiv\" style=\"DISPLAY: none\" >\r\n      [-0.08041892945766449, -0.023566607385873795, 0.04585130512714386, 0.037420596927404404, -0.09120217710733414, 0.022545181214809418, -0.0019880179315805435, 0.0587424635887146, 0.07126272469758987, -0.02159898355603218, -0.07145281136035919, 0.09984641522169113, -0.05501342564821243, 0.02485564909875393, 0.01755008101463318, 0.014556304551661015, -0.15110555291175842, -0.000567720562685281, 0.10030079632997513, -0.045505933463573456, -0.06274029612541199, -0.0683555155992508, 0.0008911662152968347, 0.01842709816992283, 0.06299598515033722, 0.02255615033209324, -0.09917508065700531, -0.07070962339639664, 0.08635025471448898, 0.06686452776193619, -0.0407336950302124, -0.04072333127260208, -0.01974628120660782, 0.07472220063209534, -0.024722471833229065, -0.13420116901397705, -0.01812688820064068, -0.07096941769123077, -0.05353084206581116, -0.10960721969604492, -0.017906684428453445, -0.04733094945549965, -0.02091103047132492, 0.1269848346710205, -0.05413510650396347, -0.046787846833467484, 0.0024005023296922445, -0.07217800617218018, -0.029329143464565277, 0.007498500403016806, -0.034666456282138824, -0.03568940982222557, 0.03427724167704582, 0.02315753698348999, -0.008645392023026943, 0.05333952233195305, 0.07456360012292862, 0.147796630859375, -0.006483903620392084, -0.08905889838933945, 0.03265034034848213, -0.0732979029417038, 0.04066538065671921, 0.023211032152175903, -0.012049349024891853, -0.02828565053641796, 0.019329581409692764, 0.09989447146654129, 0.1430598795413971, -0.061100199818611145, -0.030345138162374496, -0.02984507940709591, -0.028366880491375923, 0.052052564918994904, 0.036766957491636276, 0.003982939291745424, -0.077084481716156, 0.05044832453131676, -0.11687757074832916, 0.06646141409873962, 0.016255078837275505, -0.06982151418924332, -0.000822143629193306, -0.0026820336934179068, -0.004263593349605799, 0.09659365564584732, 0.06130471080541611, -0.06840908527374268, 0.06686245650053024, -0.04831290245056152, 0.08598440140485764, 0.08331689983606339, 0.08026000112295151, 0.05451888591051102, -0.03798443824052811, 0.04084145650267601, -0.12311697751283646, 0.023645302280783653, 0.005237551871687174, 0.03906212002038956, 0.037468183785676956, -0.05121520534157753, -0.10456130653619766, 0.009842721745371819, 0.04819759353995323, -0.13286681473255157, 0.02991127222776413, -0.06024811416864395, 0.04108288511633873, -0.008447377011179924, -0.07916080206632614, 0.06436653435230255, 0.017831943929195404, -0.054629500955343246, 0.027066148817539215, -0.030593710020184517, -0.10156133025884628, -0.0013401528121903539, 0.0011191506637260318, 0.009616676717996597, -0.02962290495634079, 0.0042936066165566444, 0.013841508887708187, -0.047656722366809845, -0.003912750165909529, 0.06500802934169769, 0.001283025718294084, -0.0816996768116951, 0.06566621363162994, -0.010957532562315464, -0.028156422078609467, 0.08978854864835739, -0.0003194105520378798, -0.02697799727320671, -0.006005867850035429, 0.07932088524103165, 0.021490609273314476, 0.013727870769798756, -0.019940776750445366, 0.031798265874385834, -0.0457642637193203, 0.03235720098018646, -0.022082772105932236, -0.04902353510260582, -0.11819718778133392, -0.04506421089172363, -0.046244461089372635, 0.029877550899982452, -0.07711911201477051, 0.05314543470740318, -0.09000932425260544, -0.023750705644488335, -0.05107633396983147, 0.001467616413719952, -0.02442317083477974, 0.01248782780021429, 0.06548482179641724, 0.043813593685626984, 0.06102786585688591, 0.021692050620913506, -0.052160654217004776, -0.009674523957073689, -0.072069451212883, -0.08633119612932205, -0.05121589079499245, -0.08108754456043243, 0.03608304262161255, 0.06553766876459122, -0.0727415531873703, -0.09346839785575867, -0.07251054048538208, 0.04504929482936859, -0.01773262582719326, -0.0005254627903923392, -0.0035706141497939825, 0.09068302065134048, 0.0152428038418293, 0.009525319561362267, 0.02502918615937233, 0.02807294949889183, -0.08951258659362793, 0.018022941425442696, 0.04113161191344261, -0.09941867738962173, 0.03642140328884125, 0.07755865901708603, 0.014834643341600895, -0.05757498741149902, -0.0052739898674190044, -0.03217893838882446, 0.029460914433002472, -0.03587955981492996, 0.016881171613931656, -0.015574142336845398, -0.10131996870040894, -0.01736866682767868, 0.014807181432843208, -0.03830776736140251, -0.0307577196508646, -0.04063287377357483, 0.0017508701421320438, 0.06622152030467987, 0.06959225982427597, 0.03921446576714516, -0.029292205348610878, -0.07731080055236816, -0.0757351890206337, 0.008267058990895748, 0.10628201067447662, -0.006961626932024956, -0.060704007744789124, -0.024280674755573273, -0.011232278309762478, 0.02305467799305916, -0.040246833115816116, 0.03551888465881348, -0.12048669904470444, -0.0057440041564404964, -0.008801680989563465, -0.038733456283807755, -0.0384967215359211, -0.0059003811329603195, 0.07543318718671799, 0.0029998512472957373, 0.11148137599229813, 0.0560586079955101, -0.01694066822528839, -0.020253779366612434, -0.11995487660169601, 0.10403268039226532, -0.022030610591173172, 0.019188301637768745, -0.03581297770142555, -0.04047590494155884, -0.03492145985364914, 0.027967417612671852, -0.07497915625572205, 0.032431814819574356, -0.025854842737317085, -0.10595495998859406, -0.09982465207576752, -0.05515384301543236, 0.02156943641602993, 0.05118619278073311, -0.03904290497303009, -0.022826874628663063, -0.053247928619384766, -0.10935184359550476, 0.0006719367229379714, -0.016026955097913742, 0.13483813405036926, 0.1173691526055336, -0.01902260072529316, -0.09690848737955093, -0.07585378736257553, 0.007626112550497055, 0.019889818504452705, -0.008633404038846493, 0.010355712845921516, 0.035737670958042145, 0.011519350111484528, -0.005264237057417631, -0.06305427849292755, -0.026263760402798653, 0.008310412988066673, -0.0068666874431073666, -0.13443514704704285, -0.025350390002131462, -0.0079041114076972, 0.014966381713747978, 0.01571144163608551, 0.06266333907842636, 0.05788900703191757, -0.022854981943964958, 0.09513315558433533, 0.1284472942352295, -0.061813995242118835, -0.049407169222831726, -0.10701776295900345, 0.06945358961820602, -0.07409369200468063, -0.028664348646998405, -0.0144350565969944, 0.029182329773902893, 0.007034373469650745, -0.026693496853113174, 0.0590004064142704, -0.002902168082073331, 0.12047384679317474, 0.023063501343131065, -0.05780957639217377, 0.058589596301317215, 0.02074800431728363, -0.030389118939638138, -0.002812192542478442, 0.06409497559070587, -0.0015993582783266902, 0.007702010218054056, 0.013223372399806976, 0.012501182034611702]\r\n    </div>\r\n    <h2>About the word</h2>\r\n    <ul>\r\n      <li><span style = \"font-size:larger;\">\r\n        <a target=\"_blank\" href=\"https://duckduckgo.com/?q=computer\">\r\n        Search &laquo;computer&raquo; in&nbsp;the Internet\r\n        </a></span>\r\n      </li>\r\n      <li><span style = \"font-size:larger;\">\r\n        <a target=\"_blank\" href=\"https://en.wiktionary.org/wiki/computer\">\r\n        &laquo;computer&raquo; in&nbsp;the Wiktionary\r\n        </a></span>\r\n      </li>\r\n    </ul>\r\n    <hr/>\r\n  </div>\r\n  <div class=\"col-md-6\">\r\n     <!-- Illustration --><a href=\"https://en.wikipedia.org/wiki/computer\" target=\"_blank\">\r\n    <img src = 'https://commons.wikimedia.org/wiki/Special:FilePath/Acer_Aspire_8920_Gemstone_by_Georgy.JPG?width=300' alt = \"computer in&nbsp;Wikipedia\"\r\n      title = \"computer in&nbsp;Wikipedia\" class=\"img-responsive\">\r\n    </a>\r\n    <hr/>\r\n    <!-- Vector plot of the word -->\r\n    <h2>Vector plot</h2>\r\n    <a href=\"/explore/embeddings/data/images/singleplots/MOD_enwiki_upos_skipgram_300_2_2021_77ae823007027c0a1b020789297d1fc1.png\" target=\"_blank\">\r\n    <img src = '/explore/embeddings/data/images/singleplots/MOD_enwiki_upos_skipgram_300_2_2021_77ae823007027c0a1b020789297d1fc1.png' alt = \"computer_NOUN vector plot; click for full-size image\"\r\n      title = \"computer_NOUN vector plot; click for full-size image\" class=\"img-responsive\">\r\n    </a>\r\n  </div>\r\n</div>\r\n\r\n    <div class=\"text-nowrap\">\r\n      <hr>\r\n      <p style=\"text-align:right;\"><a href='https://www.mn.uio.no/ifi/english/research/groups/ltg/'>Language Technology Group</a>\r\n      <a href=\"https://uio.no\"><img width='50' src=\"/explore/embeddings/data/images/uio.png/\" title='University of Oslo' alt='University of Oslo'></a></p>\r\n      <p style=\"text-align:right;\"><a href='http://vectors.nlpl.eu/'>Nordic Language Processing Laboratory</a>\r\n      <a href=\"http://vectors.nlpl.eu\"><img width='60' src=\"/explore/embeddings/data/images/nlpl_logo.png/\" title='Nordic Language Processing Laboratory' alt='Nordic Language Processing Laboratory'></a></p>\r\n      <p style=\"text-align:right;\"><a rel=\"license\" href=\"http://creativecommons.org/licenses/by/4.0/\"><img alt=\"Creative Commons License\" title=\"Creative Commons License\" style=\"border-width:0\" src=\"/explore/embeddings/data/images/88x31.png/\" /></a></p>\r\n\r\n    </div>\r\n  </div>\r\n</div>\r\n<script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js\"></script>\r\n<script src=\"https://d3js.org/d3.v3.min.js\"></script>\r\n<script src=\"/explore/embeddings/data/js/bootstrap.min.js/\"></script>\r\n<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->\r\n<script src=\"/explore/embeddings/data/js/ie10-viewport-bug-workaround.js/\"></script>\r\n<script src=\"/explore/embeddings/data/js/typeahead/bloodhound.min.js/\"></script>\r\n<script src=\"/explore/embeddings/data/js/typeahead/typeahead.bundle.min.js/\"></script>\r\n<script src=\"/explore/embeddings/data/js/hint.js/\"></script>\r\n<script src=\"/explore/embeddings/data/js/addfield.js/\"></script>\r\n<script src=\"/explore/embeddings/data/js/sorttable.js/\"></script>\r\n<script src=\"/explore/embeddings/data/js/filter.js/\"></script>\r\n<script src=\"/explore/embeddings/data/js/genviz.js\"></script>\r\n<style>.etrogezratnashim1236{background-color:rgba(255,192,203,0.5);position: fixed;font-size: 18px;z-index: 100000;font-weight: bold;}  .etrogezratnashim1236:hover{display:none;} @media print{ .etrogezratnashim1236{display: none !important;}}\r\n</style>\r\n<div class=\"etrogezratnashim1236\" style=\"bottom: 8px;left: 16px;\">הגלישה באתרוג במסלול מתחם נשים</div>\r\n<div class=\"etrogezratnashim1236\" style=\"bottom: 8px;right: 16px;\">הגלישה באתרוג במסלול מתחם נשים</div>\r\n<script>if(window.top!=window.self){var style = document.createElement('style');style.type = 'text/css';style.innerHTML = '.etrogezratnashim1236 { display: none; }';document.getElementsByTagName('head')[0].appendChild(style);}</script>\r\n</body>\r\n</html>";
            startP = htmlCode.IndexOf("<ol id=\"MOD_enwiki_upos_skipgram_300_2_2021\" style=\"max-width:300px;\">");
            startP += 70;
            endP = htmlCode.IndexOf("<", startP);
            for (int i = 0; i < 10; i++)
            {
                startP = htmlCode.IndexOf("data-word", endP);
                startP += 11;
                wordStart = startP;
                wordWnd = htmlCode.IndexOf('_', wordStart);
                startP = htmlCode.IndexOf("</a>", wordWnd);
                startP = htmlCode.IndexOf("0", startP);
                endP = htmlCode.IndexOf("<", startP);
                word = htmlCode.Substring(wordStart, wordWnd - wordStart);
                frequency = float.Parse(htmlCode.Substring(startP, endP - startP));
                similarWords.Add(word, frequency);
            }
            return similarWords;
        }

        private static readonly ProcessStartInfo _startInfo = new ProcessStartInfo
        {
            //Python interpreter הגדרת את הנתיב של קובץ ההפעלה של  
            FileName = @"C:\Program Files (x86)\Microsoft Visual Studio\Shared\Python39_64\python.exe",
            //הגדרת הדגל כדי לנתב מחדש את הפלט הסטנדרטי של התהליך
            RedirectStandardOutput = true,
            //הגדרת הדגל כדי לציין שהתהליך לא אמור להיות מופעל על ידי מעטפת מערכת ההפעלה
            UseShellExecute = false,
        };
        public Dictionary<string,double> getSimilarWordsPython(string word)
        {
            //יצירת מילון לאחסון המילים הדומות וציוני הדמיון שלהן
            Dictionary<string,double> similarWords=new Dictionary<string, double>();
            //Python הגדרת את הארגומנטים להפעלת הסקריפט של 
            _startInfo.Arguments = $@"C:\Users\1\PycharmProjects\firstLesson\word2vec.py {word}";
            //Python התחל תהליך חדש להפעלת הסקריפט של      
            using (Process process = Process.Start(_startInfo))
            {
                using (StreamReader reader = process.StandardOutput)
                {
                    //Python קריאת את הפלט של הסקריפט של 
                    string result = reader.ReadToEnd();
                    //קריאת הנתונים שהגיעו בתור json
                    dynamic data = Newtonsoft.Json.JsonConvert.DeserializeObject(result);
                    //בדוק אם הנתונים אינםnull    
                    if (data != null)
                    {
                        foreach (var item in data)
                        {
                            //קבל, המילה ואת ציון הדמיון לכל מילה
                            string w = item[0].Value;
                            double sim = item[1].Value;
                            //הוספת המילה וציון הדמיון למילון
                            similarWords.Add(w, sim);
                        }
                    }
                }
            }
            //החזרת מילון המילים הדומות ואת ציוני הדמיון שלהן
            return similarWords;
        }
    }
}
